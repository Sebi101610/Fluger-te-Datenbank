<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Flugger√§te Suche</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background-image: url("patrouillesuisse.jpg");
  background-size: cover;
  background-position: center;
  background-attachment: fixed;
  color: white;
}

h1 {
  text-align: center;
  margin: 20px;
  text-shadow: 2px 2px 6px black;
}

.search-box {
  text-align: center;
  margin-bottom: 10px;
}

input {
  padding: 10px;
  width: 320px;
  font-size: 1em;
}

button {
  padding: 10px 15px;
  margin: 5px;
  font-size: 0.9em;
  cursor: pointer;
}

table {
  width: 90%;
  margin: 20px auto;
  border-collapse: collapse;
  background: rgba(0,0,0,0.75);
}

th, td {
  border: 1px solid white;
  padding: 10px;
  text-align: center;
}

th {
  background: rgba(0,120,255,0.9);
}

img {
  max-width: 150px;
  border-radius: 5px;
}
</style>
</head>

<body>

<h1>Flugger√§te Datenbank</h1>

<div class="search-box">
  <input id="search" placeholder="z.B. F22, P-51, A380"
         onkeypress="if(event.key==='Enter')searchAircraft()">
  <br>
  <button onclick="searchAircraft()">Suchen</button>
  <button onclick="showMissing()">Fehlende anzeigen</button>
</div>

<table id="table">
<tr>
  <th>Name</th>
  <th>Typ</th>
  <th>Hersteller</th>
  <th>Max. Gewicht</th>
  <th>Sitzpl√§tze</th>
  <th>Max. Geschwindigkeit</th>
  <th>Bild</th>
</tr>
</table>

<script>
// ====== LOKALE SPEZIFIKATIONEN ======
const specs = {
  "a380": ["Flugzeug","Airbus","575.000 kg","555","1020 km/h"],
  "f22": ["Kampfflugzeug","Lockheed Martin","29.000 kg","1","2410 km/h"],
  "p-51": ["Kampfflugzeug","North American","4.000 kg","1","700 km/h"],
  "segelflieger": ["Segelflugzeug","Schleicher","525 kg","1","285 km/h"],
  "falcon 9": ["Rakete","SpaceX","549.000 kg","0","27.000 km/h"],
  "air force one": ["Flugzeug","Boeing","190.000 kg","102","850 km/h"]
};

// ====== FEHLENDE SPEICHERN ======
function saveMissing(name) {
  let missing = JSON.parse(localStorage.getItem("missingAircraft")) || [];
  if (!missing.includes(name)) {
    missing.push(name);
    localStorage.setItem("missingAircraft", JSON.stringify(missing));
  }
}

// ====== SUCHE ======
async function searchAircraft() {
  const input = document.getElementById("search");
  const query = input.value.trim();
  const key = query.toLowerCase();
  const table = document.getElementById("table");

  table.querySelectorAll("tr:not(:first-child)").forEach(r => r.remove());
  if (!query) return;

  try {
    const response = await fetch(
      `https://de.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(query)}`
    );
    const data = await response.json();

    if (!data.title) {
      saveMissing(query);
      alert("Kein Wikipedia-Eintrag ‚Üí gespeichert");
      return;
    }

    const s = specs[key] || ["Nicht verf√ºgbar","Nicht verf√ºgbar","‚Äì","‚Äì","‚Äì"];

    if (s.includes("Nicht verf√ºgbar") || s.includes("‚Äì")) {
      saveMissing(data.title.toLowerCase());
    }

    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${data.title}</td>
      <td>${s[0]}</td>
      <td>${s[1]}</td>
      <td>${s[2]}</td>
      <td>${s[3]}</td>
      <td>${s[4]}</td>
      <td>${data.originalimage ? `<img src="${data.originalimage.source}">` : "‚Äî"}</td>
    `;
    table.appendChild(row);

  } catch (err) {
    console.error(err);
    saveMissing(query);
  }
}

// ====== FEHLENDE ANZEIGEN ======
function showMissing() {
  const missing = JSON.parse(localStorage.getItem("missingAircraft")) || [];
  if (missing.length === 0) {
    alert("Keine fehlenden Flugger√§te üëç");
    return;
  }
  alert("Diese Flugger√§te fehlen noch:\n\n" + missing.join("\n"));
}
</script>

</body>
</html>
