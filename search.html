<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Flugger√§te Datenbank</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: url('patrouillesuisse.jpg') no-repeat center center fixed;
  background-size: cover;
  color: white;
  text-align: center;
}

main {
  padding-top: 50px;
}

input, button {
  padding: 6px 10px;
  margin: 4px;
  font-size: 16px;
}

table {
  margin: 20px auto;
  width: 90%;
  max-width: 800px;
  border-collapse: collapse;
  background: rgba(0,0,0,0.5);
}

th, td {
  border: 1px solid white;
  padding: 8px;
}

#aircraftImage {
  max-width: 320px;
  margin: 20px auto;
  display: none;
  border-radius: 8px;
}
</style>
</head>

<body>
<main>
  <h1>Flugger√§te Suche</h1>

  <input id="searchInput" placeholder="z.B. F-22, A380, P-51"
         onkeypress="if(event.key==='Enter') searchAircraft()">
  <button onclick="searchAircraft()">Suchen</button>

  <img id="aircraftImage" alt="Flugzeug Bild">

  <table id="resultTable">
    <tr>
      <th>Name</th>
      <th>Typ</th>
      <th>Hersteller</th>
      <th>Gewicht</th>
      <th>Sitzpl√§tze</th>
      <th>Geschwindigkeit</th>
    </tr>
  </table>
</main>

<script>
/* üîç Suchfunktion */
async function searchAircraft() {
  const searchInput = document.getElementById("searchInput");
  const name = searchInput.value.trim();
  if (!name) return;

  // Bild laden
  loadAircraftImage(name);

  // Daten aus "localStorage" (Beispiel) holen
  const savedData = JSON.parse(localStorage.getItem("aircrafts") || "{}");
  const key = name.toLowerCase();

  const table = document.getElementById("resultTable");
  table.innerHTML = `
    <tr>
      <th>Name</th><th>Typ</th><th>Hersteller</th>
      <th>Gewicht</th><th>Sitzpl√§tze</th><th>Geschwindigkeit</th>
    </tr>`;

  if (savedData[key]) {
    const d = savedData[key];
    table.innerHTML += `
      <tr>
        <td>${d.name}</td>
        <td>${d.typ}</td>
        <td>${d.hersteller}</td>
        <td>${d.gewicht}</td>
        <td>${d.sitze}</td>
        <td>${d.speed}</td>
      </tr>`;
  } else {
    table.innerHTML += `
      <tr>
        <td colspan="6">Keine Daten gefunden</td>
      </tr>`;
  }
}

/* üñº Automatisches Bild von Wikimedia Commons */
async function loadAircraftImage(name) {
  const img = document.getElementById("aircraftImage");

  const api =
    "https://commons.wikimedia.org/w/api.php" +
    "?action=query&format=json&origin=*" +
    "&generator=search" +
    "&gsrsearch=" + encodeURIComponent(name + " aircraft") +
    "&gsrlimit=1&prop=imageinfo&iiprop=url";

  try {
    const res = await fetch(api);
    const data = await res.json();
    const pages = data.query?.pages;
    if (!pages) throw "kein Bild gefunden";

    const page = Object.values(pages)[0];
    img.src = page.imageinfo[0].url;
  } catch {
    img.src = "images/no-image.jpg"; // optionales Fallback
  }

  img.style.display = "block";
}

/* Beispiel-Daten zum Testen */
if (!localStorage.getItem("aircrafts")) {
  const testData = {
    "a380": {name:"A380", typ:"Passagierflugzeug", hersteller:"Airbus", gewicht:"575000 kg", sitze:"525", speed:"1020 km/h"},
    "f-22": {name:"F-22", typ:"Kampfflugzeug", hersteller:"Lockheed Martin", gewicht:"19700 kg", sitze:"1", speed:"2410 km/h"},
    "p-51": {name:"P-51", typ:"Jagdflugzeug", hersteller:"North American", gewicht:"3800 kg", sitze:"1", speed:"703 km/h"}
  };
  localStorage.setItem("aircrafts", JSON.stringify(testData));
}
</script>

</body>
</html>
