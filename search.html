<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fluggeräte Suche</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
    height: 100%;
    background: src="https://i.ibb.co/fGBdMjkD/IMG-1931.jpg" alt= "patrouille-suisse"no-repeat center center fixed;
    background-size: cover;
    color: #fff;
  }

  h1 {
    text-align: center;
    margin-top: 20px;
    text-shadow: 2px 2px 6px black;
  }

  #sucheContainer {
    text-align: center;
    margin: 20px 0;
  }

  #searchInput {
    padding: 10px;
    font-size: 1em;
    width: 60%;
    max-width: 400px;
    border-radius: 5px;
    border: none;
    outline: none;
  }

  #tabelle {
    width: 90%;
    max-width: 1200px;
    margin: 0 auto;
    border-collapse: collapse;
    background: rgba(0,0,0,0.7);
  }

  #tabelle th, #tabelle td {
    border: 1px solid #fff;
    padding: 10px;
    text-align: center;
    color: #fff;
  }

  #tabelle th {
    background-color: rgba(0, 128, 255, 0.8);
  }

  #tabelle tr:nth-child(even) {
    background-color: rgba(255,255,255,0.1);
  }

  #tabelle tr:nth-child(odd) {
    background-color: rgba(0,0,0,0.3);
  }

  img {
    max-width: 150px;
    border-radius: 5px;
  }

  #noResult {
    text-align: center;
    color: red;
    font-weight: bold;
    margin-top: 20px;
    text-shadow: 1px 1px 2px black;
  }
</style>
</head>
<body>

<h1>Fluggeräte Suche</h1>

<div id="sucheContainer">
  <input type="text" id="searchInput" placeholder="Fluggerät eingeben (z.B. A380, F22, Air Force One)" 
         onkeypress="if(event.key==='Enter'){searchAircraft(this.value);}">
</div>

<table id="tabelle">
  <tr>
    <th>Name</th>
    <th>Typ</th>
    <th>Hersteller</th>
    <th>Max. Gewicht</th>
    <th>Sitzplätze</th>
    <th>Max. Geschwindigkeit</th>
    <th>Bild</th>
  </tr>
</table>

<div id="noResult" style="display:none;">Kein Fluggerät gefunden!</div>

<script>
const tabelle = document.getElementById("tabelle");
const noResult = document.getElementById("noResult");

async function searchAircraft(query) {
  tabelle.querySelectorAll("tr:not(:first-child)").forEach(row => row.remove());
  noResult.style.display = "none";

  if(!query) return;

  // SPARQL-Abfrage: alle relevanten Properties
  const sparql = `
  SELECT ?item ?itemLabel ?typeLabel ?manufacturerLabel ?weight ?capacity ?speed ?image WHERE {
    ?item rdfs:label ?itemLabel.
    FILTER(CONTAINS(LCASE(?itemLabel), "${query.toLowerCase()}")).
    OPTIONAL { ?item wdt:P31 ?type. }
    OPTIONAL { ?item wdt:P176 ?manufacturer. }
    OPTIONAL { ?item wdt:P2067 ?weight. }   # Max Gewicht
    OPTIONAL { ?item wdt:P1093 ?capacity. } # Sitzplätze
    OPTIONAL { ?item wdt:P1119 ?speed. }    # Max Geschwindigkeit
    OPTIONAL { ?item wdt:P18 ?image. }      # Bild
    SERVICE wikibase:label { bd:serviceParam wikibase:language "de,en". }
  } LIMIT 1`;

  const url = "https://query.wikidata.org/sparql?query=" + encodeURIComponent(sparql) + "&format=json";

  try {
    const response = await fetch(url);
    const data = await response.json();
    if(data.results.bindings.length === 0){
      noResult.style.display = "block";
      return;
    }

    const res = data.results.bindings[0];

    const name = res.itemLabel?.value || "Nicht verfügbar";
    const typ = res.typeLabel?.value || "Nicht verfügbar";
    const hersteller = res.manufacturerLabel?.value || "Nicht verfügbar";
    const maxGewicht = res.weight?.value || "Nicht verfügbar";
    const sitzplaetze = res.capacity?.value || "Nicht verfügbar";
    const geschwindigkeit = res.speed?.value || "Nicht verfügbar";
    const bild = res.image?.value || "";

    const row = document.createElement("tr");
    row.innerHTML = `
      <td>${name}</td>
      <td>${typ}</td>
      <td>${hersteller}</td>
      <td>${maxGewicht}</td>
      <td>${sitzplaetze}</td>
      <td>${geschwindigkeit}</td>
      <td>${bild ? `<img src="https://commons.wikimedia.org/wiki/Special:FilePath/${encodeURIComponent(bild)}" alt="${name}">` : "Kein Bild"}</td>
    `;
    tabelle.appendChild(row);

  } catch(err){
    console.error(err);
    noResult.style.display = "block";
  }
}
</script>

</body>
</html>
